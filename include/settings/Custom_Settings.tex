\usepackage{microtype} % make everything look a tiny bit better

%\overfullrule=1mm % Debug overfull/underfull hbox

% intelligent quotation marks, language and nesting sensitive
\usepackage[autostyle]{csquotes}

\usepackage{mathtools}


% nice, small fracs for the text with \sfrac{}{}
\usepackage{xfrac}

% make the gather environment scale the equation down if it is too large
\usepackage{resizegather}

\usepackage[version=4]{mhchem}
\usepackage{physics}
\usepackage{siunitx}
\AtBeginDocument{\RenewCommandCopy\qty\SI} % the physics package overwrites \qty
% silence the warning of the conflict between siunitx and physics
% https://tex.stackexchange.com/questions/681700/silencing-siunitx-and-physics-package-qty-warning
\ExplSyntaxOn
\msg_redirect_name:nnn{siunitx}{physics-pkg}{none}
\ExplSyntaxOff

\sisetup{range-units=single} 



% better vector arrows
\usepackage[esvecta, old-arrows, allcommands]{overarrows}
%\usepackage[a]{esvect}

\usepackage{booktabs}       % \toprule, \midrule, \bottomrule, etc
\usepackage{multirow}       % multiple row spanning cells

% keep figures and tables in the section
\usepackage[section, below]{placeins}

\usepackage{enumitem} % Custom list environments

\usepackage{cleveref}
%\usepackage{bookmark}
%\usepackage[shortcuts]{extdash}

\usepackage[
  backend=biber,   % use modern biber backend
  sorting=nyt,     % Sort the references numbering by name, year, title
  style=apa,       % use [author, year] for references
  apamaxprtauth=10,
]{biblatex}

% have the entire citation be a link, not only the year
% https://tex.stackexchange.com/questions/15951/hyperlink-name-with-biblatex-authoryear-biblatex-1-4b/27107#27107
\DeclareFieldFormat{citehyperref}{%
  \DeclareFieldAlias{bibhyperref}{noformat}% Avoid nested links
  \bibhyperref{#1}}

\DeclareFieldFormat{textcitehyperref}{%
  \DeclareFieldAlias{bibhyperref}{noformat}% Avoid nested links
  \bibhyperref{%
    #1%
    \ifbool{cbx:parens}
      {\bibcloseparen\global\boolfalse{cbx:parens}}
      {}}}

\savebibmacro{cite}
\savebibmacro{textcite}

\renewbibmacro*{cite}{%
  \printtext[citehyperref]{%
    \restorebibmacro{cite}%
    \usebibmacro{cite}}}

\renewbibmacro*{textcite}{%
  \ifboolexpr{
    ( not test {\iffieldundef{prenote}} and
      test {\ifnumequal{\value{citecount}}{1}} )
    or
    ( not test {\iffieldundef{postnote}} and
      test {\ifnumequal{\value{citecount}}{\value{citetotal}}} )
  }
    {\DeclareFieldAlias{textcitehyperref}{noformat}}
    {}%
  \printtext[textcitehyperref]{%
    \restorebibmacro{textcite}%
    \usebibmacro{textcite}}}

\addbibresource{references.bib}  % the bib file to use

% https://tex.stackexchange.com/questions/588454/modify-apa-style-in-biblatex
%\DeclareFieldFormat[article,periodical]{volume}{\mkbibbold{#1}}
\DeclareFieldFormat[article,report,book,unpublished,inproceedings,thesis]{title}{\mkbibitalic{#1}}
\DeclareFieldFormat[article,report,book,unpublished,inproceedings,thesis]{volume}{\mkbibbold{#1}}
\DeclareFieldFormat[article,report,book,unpublished,inproceedings,thesis]{journaltitle}{#1}
\AtEveryBibitem{\clearfield{urldate} \clearfield{urlyear} \clearfield{urlmonth} \clearfield{urlday} }% remove "Retrieved on ..."
\AtEveryBibitem{\clearfield{number}} % remove issue numbers
\DeclareFieldFormat{apacase}{#1}
%\DeclareFieldFormat[article,report,book,unpublished,inproceedings,thesis]{urldate}{}
%\DeclareFieldFormat[article,report,book,unpublished,inproceedings,thesis]{titlecase}{#1}
\urlstyle{tt}

% make the URL have the "URL: " infront
% taken from https://github.com/plk/biblatex-apa/blob/master/tex/latex/biblatex-apa/bbx/apa.bbx
% and slightly edited
\DeclareFieldFormat{doi}{\mkbibacro{URL}\addcolon\space%
  \ifhyperref
    {\href{https://doi.org/#1}{\nolinkurl{https://doi.org/#1}}}
    {\nolinkurl{https://doi.org/#1}}%
  \nopunct}
\DeclareFieldFormat{url}{\mkbibacro{URL}\addcolon\space\url{#1}\nopunct}


\usepackage[acronym]{glossaries} % https://www.overleaf.com/learn/latex/Glossaries

\usepackage{svg}

\usepackage{wrapfig}

% include bibliography and table of contents in the table of contents
%\usepackage{tocbibind}

% I have a reference that contains the unicode beta
\DeclareUnicodeCharacter{03B2}{{$\beta$}}
\DeclareUnicodeCharacter{2207}{{$\nabla$}}


\hypersetup{
  pdfkeywords={fusion plasma, magnetic confinement, pellet injection, ablation, pellet rocket acceleration, asymmetric heating, NGS model},
}

\usepackage{pdflscape}

