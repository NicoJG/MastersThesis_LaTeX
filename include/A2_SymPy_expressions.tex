\section{Asymmetric NGS model expressions derived with SymPy}
\label{sec:appendix_sympy_expressions}

\begingroup
\renewcommand*{\arraystretch}{2}
This section provides the full expressions found for the normalized asymmetric NGS model, as explained in \cref{ssec:asymmetric_perturbation_model}.
Algebraic operations were performed using the Python package SymPy, since the expressions are too large to handle manually.
Consider the system of \cref{eq:physical_perturbation_ideal_gas_law,eq:physical_perturbation_mass_conservation,eq:physical_perturbation_r_momentum_conservation,eq:physical_perturbation_energy_conservation,eq:physical_perturbation_theta_momentum_conservation,eq:physical_perturbation_effective_heat_flux,eq:physical_perturbation_electron_energy_loss} with $l=1$ and the changes due to normalization listed after \cref{eq:perturbation_normalized_bc}.
It describes the normalized perturbation $\vec{y}_1$ to the isotropic NGS model $\vec{y}_0$ and is now written in the form
\begin{equation}
    A \pdv{\vec{y}_1}{r} = B \vec{y}_1 \quad \text{with} \quad \vec{y}_1 = (p_1, T_1, v_{1,r}, v_{1,\theta}, q_1, E_1)^T \, .
\end{equation}
Since all the following expressions contain only the isotropic NGS model quantities, the subscript 0 is omitted.
We also denote $y' = \partial y/ \partial r$ and $\lambda = \lambda_\star$.
The corresponding matrices are
\begin{gather}
    \input{include/exported_latex/A} \\
    \intertext{and}
    \input{include/exported_latex/B} \, .
\end{gather}
We have denoted
\begin{gather}
    k = \frac{1}{2} \rho v^2 + \frac{p}{\gamma-1} \, , \\
    \vec{\nabla} \cdot \vec{v} = \frac{1}{r^2} \cdot \frac{d}{dr}(r^2 v) \, .
\end{gather}
Symbolic computation allows us to find an analytic expression for $C = A^{-1}B$ so that
\begin{equation}
\boxed{%
    \pdv{\vec{y}_1}{r} = C \vec{y}_1} \, .
\end{equation}
The expression for matrix $C$ in terms of $3 \times 3$ blocks with $w=v^2$ is provided on the next page.

\begin{landscape}
\begin{gather}
    \input{include/exported_latex/C} \, .
\end{gather}
\end{landscape}

As can be seen, the first three rows of $C$ share the apparent singularity $1/(T_0 - v_0^2)$ at $r=1$.
We now require that $\vec{y}'_1(r=1)$ is finite.
Defining the singularity-reduced matrix $D = (T_0 - v_0^2)C$, the first three rows of $D(r=1)$ are
\begin{gather}
    \input{include/exported_latex/D1} \, ,
\end{gather}
where $\chi$ and $\Psi$ are defined by \cref{eq:chi_star} and $L$ is the empirical electron energy loss function of \cref{eq:energy_loss_function} normalized through \cref{eq:ngs_normalization}.
This is a matrix of rank 1 and $D(r=1)\vec{y}_1$ yields
\begin{equation}
\boxed{%
    v_{1,\theta} = \left(1- \frac{\chi_\star}{2}\right) v_{1,r} + \left(1 + \frac{\chi_\star}{4}\right)T_1 - q_1 - \frac{\Psi_\star}{2 \lambda_\star L(E=1)} E_1} \, .
\end{equation}
This is used in the numerical procedure for solving for $\vec{y}_1(r)$ to reduce the number of unknowns at the sonic radius by one.

To be able to calculate the derivatives $\vec{y}'_1(r=1)$, we need to apply L'HÃ´pital's rule in the sense
\begin{gather*}
\lim_{r\rightarrow 1} \vec{y}'_1 = \lim_{r\rightarrow 1} \frac{1}{\frac{d}{dr}(T-w)} \frac{d}{dr} \left( D \vec{y}_1 \right) \\
\Leftrightarrow \lim_{r\rightarrow 1} \vec{y}'_1 = \lim_{r\rightarrow 1} \frac{1}{\frac{d}{dr}(T-w)} \left( D' \vec{y}_1 + D\vec{y}'_1 \right) \\
\Leftrightarrow \lim_{r\rightarrow 1} \left(\frac{d}{dr}(T-w)\mathbbone{}_{6x6} - D \right) \vec{y}'_1 = \lim_{r\rightarrow 1} D' \vec{y}_1 \\
\Leftrightarrow \lim_{r\rightarrow 1} \vec{y}'_1 = \lim_{r\rightarrow 1} \left(\frac{d}{dr}(T-w)\mathbbone{}_{6x6} - D \right)^{-1} D' \vec{y}_1.
\end{gather*}
So we need to find $D'(r=1)$ and $\left(\frac{d}{dr}(T-w)\mathbbone{}_{6x6} - D \right)^{-1}|_{r=1}$. 
We also define the matrix
\begin{gather}
C_\star = \lim_{r\rightarrow 1} \left(\frac{d}{dr}(T-w)\mathbbone{}_{6x6} - D \right)^{-1} D' \\
\text{so that} \quad \Rightarrow \quad \boxed{\vec{y}'_1(r=1) = C_\star \vec{y}_1(r=1)} \, .
\end{gather}
We now define $\Xi = 4 \lambda L^2|_{E=1} \frac{d^2 \Lambda}{dE^2}|_{E=1} $ and provide the resulting large expressions for the elements of $C_\star$ on the next pages.
\begin{landscape}
\begin{gather*}
\input{include/exported_latex/Cstar}
.
\end{gather*}
\end{landscape}
\endgroup
