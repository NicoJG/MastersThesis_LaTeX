\subsection{Asymmetric perturbation model}
\label{ssec:asymmetric_perturbation_model}

Provided a procedure of calculating the full ablation dynamics under the assumption of spherical symmetry, it is now possible to describe the asymmetry in the ablation dynamics as a perturbative model.
The baseline model is the previously described NGS model, will be denoted from now on with the index 0 and can be assumed as fully known.
Assuming the real ablation process is described well by the NGS model quantities $y_0(r)$ with a small correction $\var{y}(r,\theta)$, which depends on the asymmetry along one axis ($z$-axis in \cref{fig:neutral_cloud_heating}), the full physical quantities can be modelled as
\begin{equation}
\begin{aligned}
    \rho &= \rho_0 + \var\rho\, , & 
    p &= p_0 + \var{p}\, , \\
    T &= T_0 + \var{T}\, , & 
    \vec{v} &= \hat{r} (v_0 + \var{v}_r) + \hat{\theta} (0+\var{v}_\theta)\, , \\
    q &= q_0 + \var{q}\, , & 
    E &= E_0 + \var{E}\, .
\end{aligned}
\end{equation}
The spherical coordinate system is chosen as depicted in \cref{fig:neutral_cloud_heating,fig:pellet_surface_force}, while neglecting the $\varphi$-dependence.

Treating the system as a quasi-steady-state ideal gas is retained in our model in the same way the NGS model is treated.
Therefore, the \cref{eq:ideal_gas_law,eq:full_mass_conservation,eq:full_momentum_conservation,eq:full_energy_conservation,eq:heat_flux_approximation,eq:full_effective_heat_flux,eq:full_electron_energy_loss} form the basis of our asymmetric perturbative model.
This includes the approximation of a purely radial flux of electrons, as represented by \cref{eq:heat_flux_approximation}.
Linearizing the set of equations in the perturbation quantities $\var{y}$, combined with the fact that the NGS quantities $y_0$ satisfy those equations themselves, yields
\begin{flalign}
    &\var{\rho} = m \frac{\var{p}}{T_0} - m \frac{p_0}{T_0^2} \var{T} 
    &\text{(ideal gas law),}& \label{eq:linearized_ideal_gas_law} \\
    &\vec{\nabla} \cdot (\var{\rho} \vec{v}_0 + \rho_0 \var{\vec{v}}) = 0 
    &\text{(mass conservation),}&\label{eq:linearized_mass_conservation} \\
    &\rho_0 (\vec{v}_0 \cdot \vec{\nabla})\var{\vec{v}} + \rho_0 (\var{\vec{v}} \cdot \vec{\nabla})\vec{v}_0 + \var{\rho} (\vec{v}_0 \cdot \vec{\nabla}) \vec{v}_0 = - \vec{\nabla}\var{p} 
    \span\span\nonumber\\&&\text{(momentum conservation),}&\label{eq:linearized_momentum_conservation} \\
    &\vec{\nabla} \cdot \left[ \left( \frac{1}{2}\rho_0 v_0^2 + \frac{\gamma}{\gamma - 1}p_0 \right)\var{\vec{v}} + \left( \frac{1}{2}\var{\rho} v_0^2 + \rho_0 (\vec{v}_0\cdot \var{\vec{v}}) + \frac{\gamma}{\gamma - 1}\var{p} \right)\vec{v}_0 \right] = \mu \pdv{\var{q}}{r} 
    \span\span\nonumber\\&&\text{(energy conservation),}& \label{eq:linearized_energy_conservation} \\
    &\pdv{\var{E}}{r} = 2\frac{\var{\rho}}{m}L(E_0) + 2 \frac{\rho_0}{m} \eval{\pdv{L}{E}}_{E_0}  \!\!\!\! \var{E} 
    &\text{(electron energy loss),}&\label{eq:linearized_effective_heat_flux} \\
    &\pdv{\var{q}}{r} = \frac{\var{\rho}}{m} q_0 \Lambda(E_0) + \frac{\rho_0}{m} \var{q} \Lambda(E_0) + \frac{\rho_0}{m} q_0 \eval{\pdv{\Lambda}{E}}_{E_0} \!\!\!\! \var{E} \quad
    \span\text{(effective heat flux).}& \label{eq:linearized_electron_energy_loss}
\end{flalign}

Now we want to find a set of equations for the $r$-dependence and a separate set of equations for the $\theta$-dependence.
Fortunately, this is possible without further approximations by expanding the perturbation in terms of general fully orthogonal basis functions $\{X_l(\theta)\}$ in the form
\begin{align}
\begin{aligned}
    \var{\rho} &= \sum_l \rho_l(r) X_l(\theta) \, , &
    \var{p} &= \sum_l p_l(r) X_l(\theta) \, , \\
    \var{T} &= \sum_l T_l(r) X_l(\theta) \, , &
    \var{v}_r &= \sum_l v_{l,r}(r) X_l(\theta) \, , \\
    \var{q} &= \sum_l q_l(r) X_l(\theta) \, , &
    \var{E} &= \sum_l E_l(r) X_l(\theta) \, , &
\end{aligned}
\end{align}
while expanding only $\var{v}_\theta$ in terms of a different general basis $\{Y_l(\theta)\}$ as
\begin{equation}
    \var{v}_\theta = \sum_l v_{l,\theta}(r) Y_l(\theta) \, .
\end{equation}

% the set of \cref{eq:linearized_ideal_gas_law,eq:linearized_mass_conservation,eq:linearized_momentum_conservation,eq:linearized_energy_conservation,eq:linearized_effective_heat_flux,eq:linearized_electron_energy_loss}
Taking the derivatives in terms of spherical coordinates, the only $\theta$-derivative appearing in \cref{eq:linearized_mass_conservation,eq:linearized_energy_conservation} is
\begin{equation*}
    \vec{\nabla}\cdot(\var{v}_\theta \hat{\theta}) = \frac{1}{r \sin\theta}\pdv{\theta}(\sin\theta \var{v}_\theta) \, ,
\end{equation*}
while all other terms are linear in the $\theta$-dependence.
Therefore, separating the $r$- from the $\theta$-dependence in those equations is possible by requiring
\begin{equation}
    X_l(\theta) \propto \frac{1}{\sin\theta} \pdv{\theta}(\sin\theta Y_l(\theta)) \, .
    \label{eq:X_l_requiremetn}
\end{equation}
Similarly, the only $\theta$-derivative in \cref{eq:linearized_momentum_conservation} is
\begin{equation*}
    \hat{\theta} \cdot \vec{\nabla}\var{p} = \frac{1}{r} \pdv{\var{p}}{\theta} \, ,
\end{equation*}
while the only other components in the $\hat{\theta}$-direction are linear in $\var{v}_\theta$.
This leads us to require
\begin{equation}
    Y_l(\theta) = \pdv{X_l}{\theta}\, .
    \label{eq:Y_l_requiremetn}
\end{equation}
The last two \cref{eq:linearized_effective_heat_flux,eq:linearized_electron_energy_loss} by design do not contain $\theta$-derivatives or $\var{v}_\theta$.
Combining those two requirements and choosing the proportionality constant in \cref{eq:X_l_requiremetn} to be $-1/(l(l+1))$ leads to the defining differential equation for associated Legendre polynomials $X_l(\theta) = P^0_l(\cos\theta)$.
These are precisely the $m=0$ spherical harmonics with no $\varphi$-dependence.
Thus, the $\theta$-dependence of each mode $l$ is known and leads to a set of equations for the $r$-dependent coefficients of each mode $l$.
Note that the $l=0$ mode is independent of $\theta$, which motivates our choice of notation $y_0$ for the NGS model quantities.

After a rather lengthy derivation, the set of equations describing the $r$-dependence of the asymmetric neutral ablation cloud quantities is
\begin{align}
    &\rho_l = m \left( \frac{p_l}{T_0} - \frac{p_0}{T_0^2} T_l \right) \, , \label{eq:physical_perturbation_ideal_gas_law} \\
    &\pdv{\rho_0}{r}v_{l,r} + \rho_0 \left[ \frac{1}{r^2} \pdv{r}(r^2 v_{l,r}) - \frac{l(l+1)}{r} v_{l,\theta} \right] + v_0 \pdv{\rho_l}{r} + \frac{1}{r^2}\pdv{r}(r^2 v_0) \rho_l = 0 \, , \label{eq:physical_perturbation_mass_conservation} \\
    &\rho_0 v_0 \pdv{v_{l,r}}{r} + \rho_0 \pdv{v_0}{r} v_{l,r} + v_0 \pdv{v_0}{r} \rho_l = - \pdv{p_l}{r} \, , \label{eq:physical_perturbation_r_momentum_conservation} \\
    &\rho_0 v_0 \pdv{v_{l,\theta}}{r} + \rho_0 \frac{v_0}{r} v_{l,\theta} = - \frac{p_l}{r} \, , \label{eq:physical_perturbation_theta_momentum_conservation} \\
    &\left[ v_{l,r} \pdv{r} + \frac{1}{r^2}\pdv{r}(r^2 v_{l,r}) - \frac{l(l+1)}{r} v_{l,\theta} \right] \left( \frac{1}{2} \rho v_0^2 + \frac{\gamma}{\gamma - 1} p_0 \right) \nonumber \\
    &+ \left[ v_0 \pdv{r} + \frac{1}{r^2}\pdv{r}(r^2 v_0) \right] \left( \frac{1}{2} \rho_l v_0^2 + \rho_0 v_0 v_{l,r} + \frac{\gamma}{\gamma-1}p_l \right) = \mu \pdv{q_l}{r} \, , \label{eq:physical_perturbation_energy_conservation}
\end{align}
while the electron dynamics in the neutral gas are described by
\begin{align}
    &\pdv{E_l}{r} = 2 \frac{\rho_l}{m} L(E_0) + 2 \frac{\rho_0}{m} \eval{\pdv{L}{E}}_{E_0} E_l \, , \label{eq:physical_perturbation_electron_energy_loss} \\
    &\pdv{q_l}{r} = \frac{\rho_l}{m} q_0 \Lambda(E_0) + \rho_0 q_l \Lambda(E_0) + \rho_0 q_0 \eval{\pdv{\Lambda}{E}}_{E_0} E_l \, . \label{eq:physical_perturbation_effective_heat_flux}
\end{align}

Apart from enabling the separation of variables, expansion in terms of Legendre polynomials is convenient for calculating the pellet rocket force.
As shown in \cref{sec:pellet_surface}, the pellet rocket force only depends on the projection of $\var{\rho}$, $\var{v_r}$, $\var{p}$ and $\int \var{v_\theta} \dd{\theta}$ onto $P^0_1=\cos\theta$ at the pellet surface.
Since the ablation dynamics of all $l$-modes are independent here, only the $l=1$ mode is needed in our model.
Without loss of generality, it suffices to see the perturbation quantities as
\begin{align}
\begin{aligned}
    \var{\rho} &= \rho_1(r) \cos\theta \, , &
    \var{p} &= p_1(r) \cos\theta \, , \\
    \var{T} &= T_1(r) \cos\theta \, , &
    \var{\vec{v}} &= \hat{r} v_{1,r}(r) \cos\theta - \hat{\theta} v_{1,\theta}(r) \sin\theta \, , \\
    \var{q} &= q_1(r) \cos\theta \, , &
    \var{E} &= E_1(r) \cos\theta \, . &
\end{aligned}
\end{align}
This means that for positive coefficients $y_1(r)$, the full quantity $y(\vec{r})$ has slightly increased values in the positive $\hat{z}$ direction and slightly decreased values in the negative $\hat{z}$ direction, while at $z=0$ the NGS model is unperturbed.
However, the sign of $v_{1,\theta}$ determines the direction of the angular flow velocity, which is always largest at $z=0$ and zero along the $\hat{z}$-axis.

The boundary conditions for the perturbation quantities are derived from the boundary conditions in \cref{eq:full_boundary_conditions} to be 
\begin{gather}
\begin{gathered}
    q_1(r_p) = 0, \quad
    T_1(r_p) = 0, \quad
    v_{1,\theta}(r_p) = 0, \quad
    p_1(r \rightarrow \infty) = 0, \\
    q_1(r \rightarrow \infty) = \frac{3}{2} \int_0^\pi q_\text{bc}(\theta) \cos\theta \sin\theta \dd{\theta}, \\
    E_1(r \rightarrow \infty) = \frac{3}{2} \int_0^\pi E_\text{bc}(\theta) \cos\theta \sin\theta \dd{\theta}.
\end{gathered}
\end{gather}
Since introducing $v_{1,\theta}$ adds the need for one additional boundary condition, we assume $v_{1,\theta}(r_p) = 0$.
Without assuming a particular $\theta$-dependence of the incoming electron heat flux and energy, it is projected onto the $\cos\theta$ mode.

Solving for the perturbative ablation dynamics is again not possible fully analytically, and the equations need to be prepared for numerical analysis.
The perturbation quantities $y_1$ are predicted to be on the same order of magnitude as the NGS model quantities $y_0$ times the degree of asymmetry in the external heat source.
Therefore, it turns out to be convenient to define the relative contributions of the asymmetry in the total external heat
\begin{equation}
    q_\text{rel} = \frac{q_{1}(\infty)}{q_{0}(\infty)} \quad \text{and} \quad 
    E_\text{rel} = \frac{E_{1}(\infty)}{E_{0}(\infty)} \, .
\end{equation}
The perturbation assumption requires $|q_\text{rel}| \ll 1$ and $|E_\text{rel}| \ll 1$.
Furthermore, the signs determine which side of the ablation cloud receives a higher heat flux or higher energetic electrons.

The normalization of the NGS model to the sonic radius allowed to reduce the complexity of the problem by use of additional physics knowledge in the form of \cref{eq:speed_of_sound}.
Such additional knowledge is not available for the asymmetric perturbation.
Nevertheless, it turns out to be convenient to normalize the perturbation quantities $y_1$, similarly to the NGS model, as
\begin{gather}
\begin{gathered}
    \widetilde{\rho}_1=\frac{\rho_1}{\rho_\star q_\text{rel}}, \quad 
    \widetilde{p}_1 = \frac{p_1}{p_\star q_\text{rel}}, \quad 
    \widetilde{T}_1 = \frac{T_1}{T_\star q_\text{rel}}, \quad 
    \widetilde{v}_{1,r}=\frac{v_{1,r}}{v_\star q_\text{rel}}, \quad 
    \widetilde{v}_{1,\theta}=\frac{v_{1,\theta}}{v_\star q_\text{rel}}, \\
    \widetilde{q}_1=\frac{q_1}{q_\star q_\text{rel}}, \quad 
    \widetilde{E}_1=\frac{E_1}{E_\star  q_\text{rel}}. \quad 
\end{gathered}
\end{gather}
Together with normalizing $y_0$ as previously defined in \cref{eq:ngs_normalization}, this simplifies the heat source boundary conditions to
\begin{equation}
    \widetilde{q}_{1}(\infty) = \widetilde{q}_{0}(\infty) \quad \text{and} \quad 
    \widetilde{E}_{1}(\infty) = \widetilde{E}_{0}(\infty) \frac{E_\text{rel}}{q_\text{rel}}.
\end{equation}
Again, the \textasciitilde{} notation is dropped from now on and all quantities can be considered normalized, if not stated otherwise.

The chosen normalization leaves the system of \cref{eq:physical_perturbation_ideal_gas_law,eq:physical_perturbation_mass_conservation,eq:physical_perturbation_r_momentum_conservation,eq:physical_perturbation_theta_momentum_conservation,eq:physical_perturbation_energy_conservation,eq:physical_perturbation_effective_heat_flux,eq:physical_perturbation_electron_energy_loss} nearly unchanged.
In particular, the linearity in the perturbation quantities leads to a cancellation of all $q_\text{rel}$ factors.
The only changes in terms of new factors on the right side of the equations are 
\begin{equation*}
\begin{array}{cll}
    \frac{1}{\gamma} &\quad\quad& \text{in \cref{eq:physical_perturbation_r_momentum_conservation,eq:physical_perturbation_theta_momentum_conservation},} \\
    \frac{\gamma}{\gamma-1} \frac{2}{\lambda_\star \mu} && \text{in \cref{eq:physical_perturbation_energy_conservation} and} \\
    m \lambda_\star &&\text{in \cref{eq:physical_perturbation_electron_energy_loss,eq:physical_perturbation_effective_heat_flux}.}
\end{array}
\end{equation*}
Therefore, apart from the normalized NGS model parameters $\gamma$, $E_\star$ and $\lambda_\star$, the only new parameter needed to determine the normalized perturbation is $E_\text{rel}/q_\text{rel}$.

Since the derived system of equations is linear in both the perturbation quantities $y_1$ and their derivatives $\partial y_1/\partial r$, it is convenient to write it, in terms of $6 \times 6$, $y_0$-dependent matrices $A(r)$ and $B(r)$, as
\begin{equation}
    A \pdv{\vec{y}_1}{r} = B \vec{y}_1 \quad \text{with} \quad \vec{y}_1 = (p_1, T_1, v_{1,r}, v_{1,\theta}, q_1, E_1)^T \, .
\end{equation}
Symbolic computation allows finding an analytic expression for $C = A^{-1}B$ so that
\begin{equation}
    \pdv{\vec{y}_1}{r} = C \vec{y}_1 \, .
\end{equation}
Since this expression is large and those details are not necessary here, it is only given in \cref{sec:appendix_sympy_expressions}.
However, an important feature of $C$ is, that it contains the apparent singularity $1/(T_0 - v_0^2)$ in front of the first three rows.
Requiring that $\partial \vec{y}_1/\partial r$ is finite at the sonic radius leads to a matrix $\eval{(T_0 - v_0^2)C}_{r=1}$ of which the first three rows have rank 1.
Thus, this requirement reduces the number of unknowns at the sonic radius by one in the sense of
\begin{equation}
v_{1,\theta} = \left(1- \frac{\chi_\star}{2}\right) v_{1,r} + \left(1 + \frac{\chi_\star}{4}\right)T_1 - q_1 - \frac{\Psi_\star}{2 \lambda_\star L(E=1)} E_1 \, .
\end{equation}
Equivalently to the normalized NGS model, the derivatives at $r=1$ can then be evaluated using L'HÃ´pital's rule.
The corresponding expression for $C_\star = \eval{C}_{r=1}$ is given in \cref{sec:appendix_sympy_expressions}.
Having solved this apparent singularity, everything is provided to start finding numerical solutions.


(Now I have to describe the numerical procedure.)





    \subsubsection{Analytical description}
    \subsubsection{Numerical solution}